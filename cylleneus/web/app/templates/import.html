{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center pt-4">
    <div class="col-md-9">
        <div class="card">
            <h5 class="card-header font-weight-bold">Import a text</h5>
            <div class="card-body">
                <form action="/import" method="GET" enctype="multipart/form-data" >
                    <div class="form-group">
                        <label class="h6 font-weight-bold" for="author">Author</label>
                        <input type="text"
                               class="form-control"
                               name="author"
                               autocomplete="off"
                               value="{{ author }}"
                               placeholder=""
                               required="required"
                               id="author"/>
                    </div>
                    <div class="form-group">
                        <label class="h6 font-weight-bold" for="title">Title</label>
                        <input type="text"
                               class="form-control"
                               name="title"
                               autocomplete="off"
                               value="{{ title }}"
                               placeholder=""
                               required="required"
                               id="title"/>
                    </div>
                    <div class="form-group">
                        <p class="h6 font-weight-bold">Filename</p>
                        <div class="input-group">
                            <input type="file" required="required" value="{{ path }}" class="form-control-file" name="filename" id="filename"
                                       aria-describedby="filename">
                            <label class="custom-file-label" for="filename">{{ path }}</label>
                        </div>
                    </div>
                    <script>
            $('#filename').on('change',function(){
                var fn = $(this).val();
                $(this).next('.custom-file-label').html(fn);
                if (fn) {
    var reader = new FileReader();
    reader.onload = function() {
          var text = reader.result;
          var node = document.find('#text');
          node.value = text;
        };
        reader.readAsText(fn);
        };
            })
        </script>
                    {% if success %}
                    <div class="alert alert-warning alert-dismissible show" role="alert">
                        <strong>Success!</strong> {{ file}} has been added.
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% endif %}
                    <div class="form-group">
                        <input type="text" name="text" style="display:none;" value="{{ text }}">
                    </div>
                    <div class="form-group float-right pt-2">
                        <button type="submit" id="submit" value="Import" class="btn btn-primary">Import</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}
